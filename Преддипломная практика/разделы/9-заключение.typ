#import "@local/gost732-2017:0.4.2": *
#import "@local/bmstu:0.3.0": *

= Заключение
В ходе преддипломной практики была разработана нейросетевая подсистема для дипломного приложения-редактора, предназначенная для автоматической оценки технического качества пользовательских фотографий. Базовая постановка задачи включала три технических дефекта: размытие (blur), недосвет (under) и пересвет (over). Для обучения была подготовлена выборка на основе KADIS-700K с отбором релевантных типов искажений, сформирован единый файл разметки labels.csv, выполнено разбиение train/val без утечек по сценам, а также реализован конвейер обучения в TensorFlow через tf.data.

В качестве основы модели использован EfficientNetB0 и архитектура с несколькими выходными головами. Во второй итерации была повышена стабильность обучения за счёт заморозки BatchNorm, увеличения количества нейронов у голов и частичного дообучения верхних слоёв бэкбона, расширен набор метрик для контроля качества по каждой метке. На валидационной выборке по дефектам качества получены значения: micro-accuracy = 0.9689 и exact-match accuracy = 0.9119; по головам blur достигнуты precision = 0.9863 и recall = 0.9942 (F1 = 0.9902), по over — precision = 0.8993 и recall = 0.8696 (F1 = 0.8842). Метка under оставалась наиболее сложной из-за ложных срабатываний (FP = 350 при пороге 0.5).

Для уменьшения ложных срабатываний under в финальной версии добавлена четвёртая голова night, распознающая ночные сцены. Голова night обучалась отдельно на специализированной разметке (night_train.csv/night_val.csv) без влияния на головы качества. По результатам проверки на night_val.csv достигнуты precision = 0.9806, recall = 0.9599, F1 = 0.9702 и accuracy = 0.9797, что подтверждает пригодность night для контекстной фильтрации. Дополнительно показано, что среди ложных срабатываний under на val.csv в 66.86% случаев модель одновременно предсказывает night_pred = 1 (234 из 350), то есть отключение/ослабление фильтрации under при ночной сцене позволяет существенно снизить число ложноположительных срабатываний и приблизить уровень FP по under к значениям других голов.

Таким образом, разработанная четырёхголовая модель обеспечивает высокое качество распознавания размытия и пересвета, а также предоставляет практический механизм уменьшения ошибок по недосвету за счёт учёта контекста сцены. Полученная версия может быть встроена в дипломное приложение для автоматического отбора фотографий с возможностью настройки порогов и правил фильтрации на уровне прикладной логики.
